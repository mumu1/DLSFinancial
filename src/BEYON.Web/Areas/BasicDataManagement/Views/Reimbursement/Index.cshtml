@using BEYON.Domain.Model.App

<header role="heading">
  <h2>报销事项字典表维护</h2>
</header>
    <!-- widget div-->

    <div>

        <!-- widget edit box -->
        <div class="jarviswidget-editbox">
            <!-- This area used as dropdown edit box -->
            
        </div>
        <!-- end widget edit box -->
        <!-- widget content -->
        <div class="widget-body no-padding">         
            <button id="create_btn" class="btn btn-primary " type="button">新增</button>
            <button id="edit_btn" class="btn btn-primary" type="button">编辑</button>
            <button id="delete_btn" class="btn btn-primary" type="button">删除</button>   
                <table id="datatable_tabletools" class="table table-striped table-bordered table-hover" ></table>
        </div>
        <!-- end widget content -->

    </div>
    <!-- end widget div -->



<script type="text/javascript">
    $(function () {
        loadTableData();

    });
    $("#create_btn").click(function () {
        
    });
    //加载报销事项列表
    function loadTableData() {
       $.ajax({
            type: "GET",
            url: "../BasicDataManagement/Reimbursement/GetAllData",
            //data: params,
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            success: function (data) {
                initTable(data);
            },
            error: function () {
                toastr.error('获取报销事项数据失败！');
            }
        });
    }

    function initTable(data) {
        pageSetUp();
        //更新数据
        if ($.fn.dataTable.isDataTable('#datatable_tabletools')) {
            var oSettings = table.fnSettings();
            table.fnClearTable(this);
            for (var i = 0; i < data.rows.length; i++) {
                table.oApi._fnAddData(oSettings, data.rows[i]);
            }

            oSettings.aiDisplay = oSettings.aiDisplayMaster.slice();
            table.fnDraw();
            return;
        }


        table = $('#datatable_tabletools').dataTable({

            // Tabletools options:
            //   https://datatables.net/extensions/tabletools/button_options
            "sDom": "<'dt-toolbar'<'col-xs-12 col-sm-6'f><'col-sm-6 col-xs-6 hidden-xs'T>r>" +
                    "t" +
                    "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",
            
            "oTableTools": {            
                "aButtons": [
                    {
                        "sButtonText": "另存为Excel",
                        "sExtends": "xls",

                    }
                ],
                "sSwfPath": "../Scripts/plugin/datatables/swf/copy_csv_xls_pdf.swf"
            },
            "sRowSelect": "multi",
            "bPaginate": true, //是否显示（应用）分页器  
            "bSort": true, //是否启动各个字段的排序功能  
            "autoWidth": true,
            "paging": true,
            "aoColumns": [
                                    {
                                        "mRender": function (data, type, full) {
                                            sReturn = '<input type="checkbox" value="1" />';
                                            return sReturn;
                                        },
                                        "sClass": "checkboxes"
                                    },
                                    { "mDataProp": "Id", "sTitle": "编号" },
                                    { "mDataProp": "RefundTypeCode", "sTitle": "科目代码" },
                                    { "mDataProp": "RefundTypeName", "sTitle": "报销事项" }
            ],
            "data": data.rows,
            "preDrawCallback": function () {
                // Initialize the responsive datatables helper once.

            },
            "rowCallback": function (nRow) {

            },
            "drawCallback": function (oSettings) {

            },
            "rowsGroup": [2],
            "oLanguage": {
                "sLengthMenu": "每页显示 _MENU_ 条记录",
                "sZeroRecords": "抱歉， 没有找到",
                "sInfo": "显示 _START_ 到 _END_ 条记录，总共 _TOTAL_ 条记录",
                "sInfoEmpty": "没有数据",
                "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
                "sZeroRecords": "没有检索到数据",
                "sSearch": "搜索名称:",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "前一页",
                    "sNext": "后一页",
                    "sLast": "尾页"
                }

            }
        });
    
    }

  
    </script>